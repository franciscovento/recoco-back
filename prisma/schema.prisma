// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Rol {
  normal
  manager
  super_user
}

enum UserStatus {
  active
  deleted
  blocked
}

enum Status {
  active
  draft
  reported
  deleted
}

enum CommentStatus {
  approved
  onReview
  pending
  deleted
  spam
  rejected
}

model Country {
  id Int @id @default(autoincrement())
  name String
  universities University[]
}

model User {
  id String @id @unique @default(uuid())
  email String @unique
  password String
  username String @unique
  rol Rol @default(normal)
  status UserStatus @default(active)
  is_verified Boolean @default(false)
  university_id String?
  degree_id String? 
  created_at DateTime  @default(now())
  updated_at DateTime  @updatedAt

  commentLikes CommentLikes[]
  commentDislikes CommentDisLikes []
}

model University {
  id String @id @unique @default(uuid())
  name String 
  country_id Int
  website String?
  phone String?
  status Status? @default(active)
  created_by String
  created_at DateTime  @default(now())
  updated_at DateTime  @updatedAt

  country Country @relation(fields: [country_id], references: [id])
  faculties Faculty[]
}

model Faculty {
  id String @id @unique @default(uuid())
  name String
  status Status? @default(active)
  university_id String
  created_by String
  created_at DateTime  @default(now())
  updated_at DateTime  @updatedAt
  university University @relation(fields: [university_id], references: [id])

  degrees Degree[]
  course Course[]
}

model Degree {
  id String @id @unique @default(uuid())
  name String
  description String?
  duration Decimal?
  status Status? @default(active)
  faculty_id String
  created_by String
  degreeCourses DegreeCourse[]
  created_at DateTime  @default(now())
  updated_at DateTime  @updatedAt

  faculty Faculty @relation(fields: [faculty_id], references: [id])
}

 model Teacher {
  id String @id @unique @default(uuid())
  name String
  last_name String
  score Int?
  status Status? @default(active)
  created_by String
  courseTeacher CourseTeacher[]
  created_at DateTime  @default(now())
  updated_at DateTime  @updatedAt
 }

 model Course {
  id String @id @unique @default(uuid())
  name String
  description String? 
  short_name String
  course_code String?
  faculty_id String
  status Status? @default(active)
  created_by String
  created_at DateTime  @default(now())
  updated_at DateTime  @updatedAt

  faculty Faculty @relation(fields: [faculty_id], references: [id])
  degreeCourses DegreeCourse[]
  courseTeacher CourseTeacher[]
 }

 model Comment { 
  comment String
  difficulty Int
  quality Int
  status CommentStatus @default(approved)
  course_id String
  teacher_id String
  created_by String
  created_at DateTime  @default(now())
  updated_at DateTime  @updatedAt
  commentLikes CommentLikes []
  commentDislikes CommentDisLikes []
  courseTeacher CourseTeacher @relation(fields: [course_id, teacher_id], references: [course_id, teacher_id])
  @@id([course_id, teacher_id])
 }


 model CommentLikes {
  course_id String
  teacher_id String
  user_id String
  comment Comment @relation(fields: [course_id, teacher_id], references: [course_id, teacher_id])
  user User @relation(fields: [user_id], references: [id])
   @@id([course_id, teacher_id])
 }


 model CommentDisLikes {
  course_id String
  teacher_id String
  user_id String
  comment Comment @relation(fields: [course_id, teacher_id], references: [course_id, teacher_id])
  user User @relation(fields: [user_id], references: [id])
 @@id([course_id, teacher_id])
 }

 model DegreeCourse {
  degree_id String 
  course_id String 
  created_at DateTime  @default(now())
  updated_at DateTime  @updatedAt
  created_by String
  degree  Degree @relation(fields: [degree_id], references: [id])
  course  Course @relation(fields: [course_id], references: [id])

  @@id([degree_id, course_id])
 }

 model CourseTeacher {
  course_id String 
  teacher_id String 
  quality Int?
  difficulty Int? 
  totalComments Int? @default(0)
  status Status @default(active)
  created_by String
  created_at DateTime  @default(now())
  updated_at DateTime  @updatedAt
  course Course @relation(fields: [course_id], references: [id])
  teacher Teacher @relation(fields: [teacher_id], references: [id])
  @@id([course_id, teacher_id])

  comments Comment[]
 }